---
import SearchS from "astro-pagefind/components/Search";
import "@styles/components/common/search.css";
//@ts-ignore
import * as feather from "feather-icons"; // 导入 feather-icons 以便使用
---

<div id="search-container" class="none">
    <div class="search-backdrop"></div>
    <div class="search-box">
        <div class="search-header">
            <h2>站内搜索</h2>
            <button class="search-close" id="search-close">
                <Fragment
                    set:html={feather.icons["x"].toSvg({
                        width: 24,
                        height: 24,
                        class: "close-icon",
                    })}
                />
            </button>
        </div>
        <div class="search-content">
            <div id="search-wrapper" class="none">
                <SearchS
                    id="search"
                    className="pagefind-ui"
                    uiOptions={{
                        showImages: false,
                        placeholderText: "",
                        showEmptyResults: true,
                        showSubResults: true,
                        resetStyles: true,
                        translations: {
                            placeholder: "",
                            clear_search: "清除",
                            load_more: "加载更多结果",
                            search_label: "搜索网站",
                            filters_label: "筛选",
                            zero_results: "未找到与 [SEARCH_TERM] 相关的结果",
                            many_results:
                                "找到 [COUNT] 个与 [SEARCH_TERM] 相关的结果",
                            one_result: "找到 1 个与 [SEARCH_TERM] 相关的结果",
                            searching: "搜索 [SEARCH_TERM] 中...",
                        },
                    }}
                />
            </div>
        </div>
    </div>
</div>
<script>
    document.addEventListener("openSearch", () => {
        const searchElement = document.getElementById("search-container");
        const searchWrapper = document.getElementById("search-wrapper");
        if (searchElement) {
            searchElement.classList.add("search-actives");
        }
        if (searchWrapper) {
            searchWrapper.classList.add("search-actives");
        }
    });

    document.getElementById("search-close")?.addEventListener("click", () => {
        const searchElement = document.getElementById("search-container");
        const searchWrapper = document.getElementById("search-wrapper");
        if (searchElement) {
            searchElement.classList.remove("search-actives");
        }
        if (searchWrapper) {
            searchWrapper.classList.remove("search-actives");
        }
    });
</script>
